{% extends 'base.html' %}

{% block content %}
<div style="max-width:800px; margin:2rem auto;">
  <h2>{{ video.title }}</h2>

  <div style="margin-bottom:1rem;">
    <a href="{{ url_for('download_video', video_id=video.id) }}"
       class="btn btn-primary">Скачать видео</a>
  </div>

  <div style="position:relative; padding-bottom:56.25%; height:0; overflow:hidden; margin-bottom:1rem;">
    <iframe
      src="{{ embed_url }}"
      style="position:absolute; top:0; left:0; width:100%; height:100%;"
      frameborder="0"
      allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen>
    </iframe>
  </div>

  <div style="border:1px solid #ccc; padding:1rem; position:relative; border-radius:8px;">
    <h5>Комментарий</h5>
    <p style="white-space: pre-line;">{{ video.comment }}</p>

    <div style="position:absolute; top:1rem; right:1rem; background:#f5f5f5;
                padding:0.5rem 1rem; border-radius:5px;">
      <strong>Категории:</strong><br>
      {{ video.categories | map(attribute='name') | join(', ') }}
    </div>
  </div>

  {% if related_videos %}
    <div style="margin-top:2rem;">
      <h4>Похожие видео</h4>
      <ul style="list-style:none; padding:0;">
        {% for rv in related_videos %}
          <li style="margin-bottom:1rem;">
            <a href="{{ url_for('view_video', video_id=rv.id) }}"
               style="font-weight:bold; text-decoration:none;">
              {{ rv.title }}
            </a>
            <div style="font-size:0.85rem; color:#666;">
              {{ rv.timestamp.strftime('%Y-%m-%d %H:%M') }}
            </div>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <p style="margin-top:1rem;">
    <a href="{{ url_for('profile') }}" class="btn btn-link">&larr; Назад в профиль</a>
  </p>
</div>
{% endblock %}
